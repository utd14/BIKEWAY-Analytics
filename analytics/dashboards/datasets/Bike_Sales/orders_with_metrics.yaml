table_name: orders_with_metrics
main_dttm_col: order_date
description: null
default_endpoint: null
offset: 0
cache_timeout: null
catalog: bike_sales
schema: public
sql: "SELECT \n    o.order_id,\n    o.order_date,\n    EXTRACT(YEAR FROM o.order_date)\
  \ as order_year,\n    EXTRACT(MONTH FROM o.order_date) as order_month,\n    CONCAT(c.first_name,\
  \ ' ', c.last_name) as customer_name,\n    st.store_name,\n    CONCAT(s.first_name,\
  \ ' ', s.last_name) as staff_name,\n    p.product_name,\n    cat.category_name,\n\
  \    b.brand_name,\n    oi.quantity,\n    oi.list_price,\n    oi.discount,\n   \
  \ oi.quantity * oi.list_price * (1 - oi.discount) as order_amount\nFROM orders o\n\
  JOIN customers c ON o.customer_id = c.customer_id\nJOIN stores st ON o.store_id\
  \ = st.store_id\nJOIN staffs s ON o.staff_id = s.staff_id\nJOIN order_items oi ON\
  \ o.order_id = oi.order_id\nJOIN products p ON oi.product_id = p.product_id\nJOIN\
  \ categories cat ON p.category_id = cat.category_id\nJOIN brands b ON p.brand_id\
  \ = b.brand_id\nORDER BY o.order_date DESC"
params: null
template_params: null
filter_select_enabled: true
fetch_values_predicate: null
extra: null
normalize_columns: false
always_filter_main_dttm: false
uuid: 52f93c86-a786-4064-a555-4872d9b5d482
metrics:
- metric_name: revenue_growth_years
  verbose_name: Revenue Growth (Year over Year)
  metric_type: null
  expression: (SUM(order_amount) - LAG(SUM(order_amount)) OVER (ORDER BY order_year))
    / NULLIF(LAG(SUM(order_amount)) OVER (ORDER BY order_year), 0) * 100
  description: null
  d3format: null
  currency: null
  extra:
    warning_markdown: ''
  warning_text: null
- metric_name: median_order_amount
  verbose_name: Median Order Amount
  metric_type: null
  expression: PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY order_amount)
  description: null
  d3format: null
  currency: null
  extra:
    warning_markdown: ''
  warning_text: null
- metric_name: avg_order_amount
  verbose_name: Average Order Amount
  metric_type: null
  expression: AVG(order_amount)
  description: null
  d3format: null
  currency: null
  extra:
    warning_markdown: ''
  warning_text: null
- metric_name: count
  verbose_name: COUNT(*)
  metric_type: count
  expression: COUNT(*)
  description: null
  d3format: null
  currency: null
  extra:
    warning_markdown: ''
  warning_text: null
columns:
- column_name: price_category
  verbose_name: null
  is_dttm: false
  is_active: true
  type: null
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: "CASE \n    WHEN list_price >= 3000 THEN 'Premium'\n    WHEN list_price\
    \ >= 1000 THEN 'Mid-Range'\n    WHEN list_price >= 500 THEN 'Budget'\n    ELSE\
    \ 'Entry-Level'\nEND"
  description: null
  python_date_format: null
  extra: {}
- column_name: order_year
  verbose_name: null
  is_dttm: false
  is_active: true
  type: DECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: order_amount
  verbose_name: null
  is_dttm: false
  is_active: true
  type: DECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: list_price
  verbose_name: null
  is_dttm: false
  is_active: true
  type: DECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: order_month
  verbose_name: null
  is_dttm: false
  is_active: true
  type: DECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: discount
  verbose_name: null
  is_dttm: false
  is_active: true
  type: DECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: order_date
  verbose_name: null
  is_dttm: true
  is_active: true
  type: DATETIME
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: order_id
  verbose_name: null
  is_dttm: false
  is_active: true
  type: INTEGER
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: quantity
  verbose_name: null
  is_dttm: false
  is_active: true
  type: INTEGER
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: brand_name
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: category_name
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: staff_name
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: product_name
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: customer_name
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
- column_name: store_name
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: {}
version: 1.0.0
database_uuid: f48ed8b7-a3e1-4da2-ab3f-0b5845fdd42c
